<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histórico de Pagamentos</title>
    <link rel="stylesheet" href="/static/styles/historico-pagamento.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/static/styles/variaveis.css">
</head>
<body>
    <header>
        <button class="button-back" type="button"><a href="/pag-inicial-motorista"><img src="/static/icones/seta-voltar.png" alt="imagem de uma seta para esquerda"></a></button>
        <figure>
            <div class="logo"><img src="/static/icones/logo.png" alt="logo da movebr"></div>
        </figure>
    </header>

    <div class="container">
        <div class="cabecalho-container">
            <img src="/static/icones/dinheiro.png" alt="Perfil do Usuário" class="icone-dinheiro">
            <h2>Histórico de Pagamentos</h2>
        </div>
        
        <section class="informacoes">
            <form action="/gerar-pagamento" class="ger-pagamento" method="get">
                <div class="ger-pagamento-container">
                    <button type="submit">Gerar novo pagamento</button>
                </div>
            </form>
        
            <!-- Verifica se existem pagamentos e itera sobre eles -->
            {% if pagamentos %}
                {% for pagamento in pagamentos %}
                    <table class="alunos-listados">
                        <div class="container-tabela">
                            <tbody>
                                <tr class="aluno">
                                    <td>
                                        <!-- Perfil do Aluno -->
                                        <div class="perfil-aluno">
                                            <!-- Informações básicas do Pagamento -->
                                            <div class="info-aluno">
                                                <h2>{{ pagamento.nome_aluno }}</h2> <!-- Nome do aluno -->
                                                <p><strong>Mês do pagamento:</strong> {{ pagamento.mes_pagamento }} </p>
                                                <p><strong>Data do pagamento:</strong> {{ pagamento.data_pagamento }} </p>
                                                <p><strong>Valor do pagamento:</strong> <p id="valor_pagamento">{{ pagamento.valor_pagamento }}</p> </p>
                                            </div>
                                            <button class="btn-excluir" id="excluir_pagamento">Excluir</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </div>
                    </table>
                {% endfor %}
            {% else %}
                <p>Nenhum pagamento encontrado.</p>
            {% endif %}

            <h2 class="valor_total">Valor Total: <span id="valor_total"></span></h2>
        </section>
    </div>

    <script>
        window.onload = function() {
        // Seleciona todos os elementos <p> com o id 'valor_pagamento'
        const valoresPagamento = document.querySelectorAll("#valor_pagamento");
        let total = 0;

        // Itera pelos elementos e soma os valores
        valoresPagamento.forEach(function(pagamento) {
            let valor = parseFloat(pagamento.textContent.trim()); // Converte o texto para float
            if (!isNaN(valor)) { // Verifica se é um número válido
                total += valor;
            }
        });

        // Exibe o valor total no span com id "valor_total"
        document.getElementById("valor_total").textContent = total.toFixed(2); // Formata para 2 casas decimais
        };
        </script>
    <script src="/static/js/historico-pagamento.js"></script>
</body>
</html>