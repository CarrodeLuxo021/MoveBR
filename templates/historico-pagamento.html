<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histórico de Pagamentos</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/static/styles/variaveis.css">
    <link rel="stylesheet" href="/static/styles/historico-pagamento.css">
</head>

<body>
    <header>
        <button class="button-back" type="button">
            <a href="/pag-inicial-motorista"><img src="/static/icones/seta-voltar.png"
                    alt="imagem de uma seta para esquerda"></a>
        </button>
        <figure>
            <div class="logo">
                <a href="/pag-inicial-motorista"><img src="/static/icones/movebr.png" alt="logo da movebr"></a>
            </div>
        </figure>
    </header>

    <div class="container">
        <div class="cabecalho-container">
            <img src="/static/icones/dinheiro.png" alt="Ícone de dinheiro" class="icone-dinheiro">
            <h2>Histórico de Pagamentos</h2>
        </div>

        <form action="/gerar-pagamento" method="get" class="ger-pagamento">
            <div class="ger-pagamento-container">
                <button type="submit" class="ger-pagamento">+ Gerar novo pagamento</button>
            </div>
        </form>

        <div class="informacoes">
            <!-- Verifica se há pagamentos -->
            {% if pagamentos %}
            <table class="alunos-listados">
                <thead>
                    <tr>
                        <th>Nome do Aluno</th>
                        <th>Mês do Pagamento</th>
                        <th>Data do Pagamento</th>
                        <th>Valor do Pagamento</th>
                        <!-- <th>Ações</th> -->
                    </tr>
                </thead>
                <tbody>
                    {% for pagamento in pagamentos %}
                    <tr>
                        <td><strong>{{ pagamento.nome_aluno }}</strong></td>
                        <td>{{ pagamento.mes_pagamento }}</td>
                        <td>{{ pagamento.data_pagamento }}</td>
                        <td><strong>R$ {{ pagamento.valor_pagamento }}</strong></td>
                        <!-- <td>
                                <a href="/excluir-historico/{{ pagamento.id_aluno }}">
                                    <button class="btn-excluir">Excluir</button>
                                </a>
                            </td> -->
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            {% else %}
            <p>Nenhum pagamento encontrado.</p>
            {% endif %}
        </div>

        <h2 class="valor">Valor Total: <span id="valor_total"> </span></h2>

    </div>

    <script>
        window.onload = function () {
            const valoresPagamento = document.querySelectorAll("#valor_pagamento");
            let total = 0;

            valoresPagamento.forEach(function (pagamento) {
                let valor = parseFloat(pagamento.textContent.trim());
                if (!isNaN(valor)) {
                    total += valor;
                }
            });

            document.getElementById("valor_total").textContent = total.toFixed(2);
        };
    </script>
</body>

</html>